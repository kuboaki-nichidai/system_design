:linkcss:
:stylesdir: css
:stylesheet: mystyle.css
:twoinches: width='360'
:full-width: width='100%'
:three-quarters-width: width='75%'
:two-thirds-width: width='66%'
:half-width: width='50%'  
:half-size:
:one-thirds-width: width='33%'
:one-quarters-width: width='25%'
:thumbnail: width='60'
:imagesdir: images
:sourcesdir: codes
:icons: font
:hide-uri-scheme!:
:figure-caption: 図
:example-caption: リスト
:table-caption: 表
:appendix-caption: 付録
:xrefstyle: short
:section-refsig:
:chapter-refsig:

= 要求分析

NOTE: この演習は、グループで実施します。

== 【準備】グループでモデル図を作る準備

まず、グループでモデル図を作るためにプロジェクトを準備します。
最初はマインドマップを作りたいので、要求分析のモデルを追加し、その中にマインドマップを追加します。

.グループでモデル図を作成する準備
. Zoomのブレイクアウトルームをグループで使えるようにします。
. 誰かのPCを画面共有して作用します。
. astahでプロジェクト新規作成します。
. 作成したプロジェクトのファイルを「要求分析.asta」とし、 `models` ディレクトリに保存します。
. 構造ツリーでプロジェクトを選択した状態で右クリックし、ポップアップメニューの「モデルの追加」から「モデル」を選びます。
. 追加したモデルの名前を「01_要求分析」に変更します。
. 追加したモデルを選択した状態で右クリックし、ポップアップメニューの「図の追加」から「マインドマップ」を選びます。


== 【演習】要求分析のマインドマップを作る

追加したマインドマップ（Mindmap）を使って、演習の課題を整理・議論します。
マインドマップの作成法やastahでの操作方法については、次のページを参照してください。

マインドマップのかき方「6つの法則」:: `https://www.mindmap-school.jp/mindmap/mindmap-law/`

astahのマインドマップの操作方法:: `https://astah.change-vision.com/ja/manual/464-mindmap.html`

われわれの場合は、どのようなシステムを作るのかを検討するために使います。
そこで「 <<mindmap_for_req_sys>> 」にあるようなことがらについて議論してみる必要があるでしょう。

[[mindmap_for_req_sys]]
.要求分析のマインドマップで検討したいこと
* どんな課題なのかについての情報の整理（足りないならヒアリング）
* 作ろうとしているサービスやそこで使う機器はなにかについての情報の整理
* 自分たちとしては、どのようなサービスに仕立てるのか
* どんなふうに利用してもらうのか

議論したときに出てきたことがらを（取捨しないまま）マインドマップに書き込んでいきます。

ひとしきり議論できたと思ったら、作成したマインドマップを「ツール＞画像出力＞現在の図＞PNG」を選んで保存します。
このとき、ファイル名は `req_mindmap.png` として、 `images` ディレクトに保存します。
保存できれば、下記にその図が埋め込まれます。
（もちろん、今後、必要ならいつでも更新して構いません）

.要求分析の議論で作成したマインドマップ
image::req_mindmap.png[{full-width}]

NOTE: ここでコミットしておきます。

== 【演習】要求分析のユースケース図を作る

マインドマップをもとに、システムが提供するユースケースを検討します。

.ユースケース図を作成する
. 構造ツリーで、「01_要求分析」を選択した状態で、「頭の追加」から「ユースケース図」を選びます。
. 追加した図の名前を「要求分析のユースケース図」に変更します。
. マインドマップをみながら、要求分析のユースケース図を作成します。
** システムを利用する人を探し、その役割名つけたアクターとして配置します。
** アクターに提供するサービスを探します。
** そのサービスを「（システムが）…する」という名前でユースケースとして配置します。
** 提供するサービスとそのサービスを享受するアクターとの間に関連を引きます。
** 他のユースケースはないか、他のアクターはないか、マインドマップをみて洗い出します。
** アクターやユースケースがはっきりしない、見つからないときは、マインドマップを使って議論し直します。


作成したユースケース図を「ツール＞画像出力＞現在の図＞PNG」を選んで保存します。
このとき、ファイル名は `req_use_case.png` として、 `images` ディレクトに保存します。
保存できれば、下記にその図が埋め込まれます。

.要求分析のユースケース図
image::req_use_case.png[{full-width}]


NOTE: ここでコミットしておきます。このあとも、更新のたびにコミットします（もちろん、今後、必要ならいつでも更新して構いません）。


== 【演習】要求分析のユースケース記述を書く

ユースケース図に挙げたユースケースごとに、そのサービスで発生するアクターとシステムの間のやり取りを整理します。
整理するときは「 <<usecase_desc_point>> 」を参考に、「ユースケース記述」を書きます。

[[usecase_desc_point]]
.ユースケース記述を整理するときにやること
. ユースケースを１つ選び、そのユースケース用に１つのノートを割り付けます。
. ノートのプロパティに、箇条書きでやり取りを書きます。
** アクターが何をすると、システムが何をするか
** システムが何をすると、アクターは何をするか
** その続きは…と繰り返します。
. すべてのユースケースについて、ノートを使ってユースケース記述を書きます。（保存している図も更新します）

NOTE: ここでコミットしておきます。このあとも、更新のたびにコミットします。

ユースケース図にユースケース記述を書く代わりに、 <<use_case_study>> のように、この文書の中に、ユースケース記述を記載してもよいでしょう。


== 【参考】ATMのユースケースとユースケース記述


=== アプリケーションの利用者（アクター）は誰か

アプリケーションを作るときには、そのアプリケーションを使うのは誰なのかを決めます。
なぜなら、使う人がはっきりしていないと、どのような機能やサービスを作ればよいのかを特定するのは難しいからです。
たとえば、スキーの教則本を書くことを考えてみてください。
初めてスキーを履くような人に向けた教則本と、スキーバッジテスト footnote:[公益財団法人 全日本スキー連盟が主催するアルペンスキーの技能テスト。合格すると認定バッジがもらえる。] の1級や準指導員検定を目指す上級者に向けた指導書では、書くべき内容はかなり違ったものになるはずです。

たとえば、銀行の現金自動預け払い機（Automated Teller Machine: ATM）の場合、アプリケーションの利用者をどのような名前で呼ぶとよいでしょうか。
このようなときは、特定の個人を指す氏名ではなく、このアプリケーションを使うときの立場や役割を表現した名前をつけます。
このような名前を、役割名（ロール名）といいます。
ここではATMの「利用顧客（Customer）」としておきましょう。

システム開発では、このようなアプリケーションの利用者を役割や立場で表したものを「アクター」と呼びます。
たいていの場合、アクターの名前は役割名になります。
たとえば「これから作るアプリケーションのアクターは利用顧客です」のように使います。

[[use_case_study]]
=== アプリケーションが提供する機能（ユースケース）はなにか

システム開発では、アクターから働きかけを受けてなんらかの処理を実施して、その結果をアクターに返すまでの一連の動作のことを「ユースケース」と呼びます。
ATMの場合であれば、お金を引き出すときに <<ATM_use_case_desc_draw_out>> のようなやり取りをするでしょう。

[[ATM_use_case_desc_draw_out]]
.ATMの「出金する」の動作
[example]
--
. 利用者が出金の手続きを選ぶと、ATMは出金の処理へ進み、キャッシュカードの挿入を促す。
. 利用者が、キャッシュカードを挿入すると、ATMは暗証番号の入力を促す。
. 利用者が暗証番号を入力すると、ATMは認証手続きを実施する。
. ATMは、認証手続きが成功すると、出金額の入力を促す。
. 利用者が出金額を入力すると、ATMは出金手続きを実行し、明細票を印字する。
. ATMは、カードと明細票の取り出しを促す。
. 利用者がカードと明細票を受け取ると、ATMは現金を送り出す。
. 利用者が現金を受け取ると、ATMは出金処理を終了する。
--

「出金する」ときのATMとアクターとの間のやりとりを書いてあります。このやりとりの流れ全体で1つのユースケースになります。また、具体的なやり取りを書いたこのリストのことを「ユースケース記述」と呼びます。

ATMでは、他に「入金する」「振込みする」というユースケースもあるでしょう。

=== アプリケーションのユースケース図

アプリケーションに関わるアクターとユースケースが見つかったので、アプリケーションのできあがり予想を図に表してみましょう。
たとえば、これまでに検討していた3つの機能を持つATMについてユースケース図を描いてみると <<ATM_use_case_chart>> のような図が描けます。

[[ATM_use_case_chart]]
.3つの機能を持つATMのユースケース図
image::ATM_use_case_01.svg[{three-quarters-width}]

この図を「ユースケース図」と呼びます。人型のシンボルがアクター、楕円のシンボルがユースケースです。
アクターに提供する機能がどれかわかるよう、ユースケースとの間に線が引かれています。この線を「関連」と呼びます。
関連を引いておくと、複数のアクターに対してどのユースケースが機能を提供するのか示せるようになります。

この例のATMでは、利用者は「出金する」「入金する」「振り込む」という3つの機能を使えることを示しています。
さらに、 `include` と付記した破線矢印を使ってユースケースの共通部分を示しています。
ここでは、「認証する」処理（一般には暗証番号を使った方法でしょう）は、両者に提供する3つのユースケースで共通に使うことを示しています。
また、利用顧客と「認証する」には直接の関連がありません。これは、利用顧客対して「認証する」だけという使い方は提供しないことも示しています。


